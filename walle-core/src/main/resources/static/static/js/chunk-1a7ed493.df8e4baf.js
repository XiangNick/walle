(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1a7ed493"],{"16d8":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:e.id}})},o=[],i=r("db72"),s=(r("a7be"),r("44f8"),r("a6e0"),r("547e")),n=r.n(s),l={minHeight:"200px",previewStyle:"vertical",useCommandShortcut:!0,useDefaultHTMLSanitizer:!0,usageStatistics:!1,hideModeSwitch:!1,toolbarItems:["heading","bold","italic","strike","divider","hr","quote","divider","ul","ol","task","indent","outdent","divider","table","image","link","divider","code","codeblock"]},d={name:"MarkdownEditor",props:{value:{type:String,default:""},id:{type:String,required:!1,default:function(){return"markdown-editor-"+ +new Date+(1e3*Math.random()).toFixed(0)}},options:{type:Object,default:function(){return l}},mode:{type:String,default:"markdown"},height:{type:String,required:!1,default:"300px"},language:{type:String,required:!1,default:"en_US"}},data:function(){return{editor:null}},computed:{editorOptions:function(){var e=Object.assign({},l,this.options);return e.initialEditType=this.mode,e.height=this.height,e.language=this.language,e}},watch:{value:function(e,t){e!==t&&e!==this.editor.getValue()&&this.editor.setValue(e)},language:function(e){this.destroyEditor(),this.initEditor()},height:function(e){this.editor.height(e)},mode:function(e){this.editor.changeMode(e)}},mounted:function(){this.initEditor()},destroyed:function(){this.destroyEditor()},methods:{initEditor:function(){var e=this;this.editor=new n.a(Object(i["a"])({el:document.getElementById(this.id)},this.editorOptions)),this.value&&this.editor.setValue(this.value),this.editor.on("change",(function(){e.$emit("input",e.editor.getValue())}))},destroyEditor:function(){this.editor&&(this.editor.off("change"),this.editor.remove())},setValue:function(e){this.editor.setValue(e)},getValue:function(){return this.editor.getValue()},setHtml:function(e){this.editor.setHtml(e)},getHtml:function(){return this.editor.getHtml()}}},c=d,u=r("2877"),m=Object(u["a"])(c,a,o,!1,null,null,null);t["a"]=m.exports},bcea:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-form",{ref:"boardForm",attrs:{rules:e.rules,model:e.board,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"模板编码",prop:"boardCode"}},[r("el-input",{attrs:{placeholder:"模板编码，必须保持唯一性",disabled:1==e.modify,clearable:0==e.modify},model:{value:e.board.boardCode,callback:function(t){e.$set(e.board,"boardCode",t)},expression:"board.boardCode"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"模板名称",prop:"boardName"}},[r("el-input",{attrs:{placeholder:"模板名称",clearable:0==e.modify},model:{value:e.board.boardName,callback:function(t){e.$set(e.board,"boardName",t)},expression:"board.boardName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"消息类型",prop:"messageType"}},[r("el-radio-group",{model:{value:e.board.messageType,callback:function(t){e.$set(e.board,"messageType",t)},expression:"board.messageType"}},[r("el-radio",{attrs:{label:"TEXT"}},[e._v("Text")]),e._v(" "),r("el-radio",{attrs:{label:"MARKDOWN"}},[e._v("Markdown")]),e._v(" "),r("el-radio",{attrs:{label:"LINK"}},[e._v("Link")])],1)],1),e._v(" "),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"LINK"==e.board.messageType||"MARKDOWN"==e.board.messageType,expression:"board.messageType=='LINK' || board.messageType=='MARKDOWN'"}],attrs:{label:"消息标题"}},[r("el-input",{attrs:{placeholder:"消息标题"},model:{value:e.board.title,callback:function(t){e.$set(e.board,"title",t)},expression:"board.title"}})],1),e._v(" "),"LINK"==e.board.messageType||"TEXT"==e.board.messageType?r("el-form-item",{attrs:{label:"消息正文"}},[r("el-alert",{staticStyle:{height:"30px"},attrs:{closable:!1,title:"LINK"==e.board.messageType?"消息正文，支持velocity语法，不支持艾特人员":"消息正文，支持velocity语法，并且可以通过@手机号，来艾特具体的人员",type:"success"}}),e._v(" "),r("el-input",{attrs:{type:"textarea",rows:"5",placeholder:"消息正文",clearable:0==e.modify},model:{value:e.board.content,callback:function(t){e.$set(e.board,"content",t)},expression:"board.content"}})],1):e._e(),e._v(" "),"MARKDOWN"==e.board.messageType?r("el-form-item",{attrs:{label:"消息正文"}},[r("el-alert",{staticStyle:{height:"30px"},attrs:{closable:!1,title:"消息正文，支持velocity语法，并且可以通过@手机号，来艾特具体的人员",type:"success"}}),e._v(" "),r("markdown-editor",{ref:"markdownEditor",staticStyle:{"line-height":"1px"},attrs:{options:{hideModeSwitch:!0,previewStyle:"tab"}},model:{value:e.board.content,callback:function(t){e.$set(e.board,"content",t)},expression:"board.content"}})],1):e._e(),e._v(" "),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"TEXT"==e.board.messageType||"MARKDOWN"==e.board.messageType,expression:"board.messageType=='TEXT' || board.messageType=='MARKDOWN'"}],attrs:{label:"@所有人"}},[r("el-radio-group",{model:{value:e.board.atAll,callback:function(t){e.$set(e.board,"atAll",t)},expression:"board.atAll"}},[r("el-radio",{attrs:{label:"1"}},[e._v("是")]),e._v(" "),r("el-radio",{attrs:{label:"0"}},[e._v("否")])],1)],1),e._v(" "),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"LINK"==e.board.messageType,expression:"board.messageType=='LINK'"}],attrs:{label:"跳转链接"}},[r("el-input",{attrs:{placeholder:"消息跳转链接",clearable:0==e.modify},model:{value:e.board.linkMessageUrl,callback:function(t){e.$set(e.board,"linkMessageUrl",t)},expression:"board.linkMessageUrl"}})],1),e._v(" "),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"LINK"==e.board.messageType,expression:"board.messageType=='LINK'"}],attrs:{label:"配图链接"}},[r("el-input",{attrs:{placeholder:"消息配图链接",clearable:0==e.modify},model:{value:e.board.linkPicUrl,callback:function(t){e.$set(e.board,"linkPicUrl",t)},expression:"board.linkPicUrl"}})],1),e._v(" "),e._l(e.board.addresses,(function(t,a){return r("el-form-item",{key:a,attrs:{label:"接收目标"+(a+1)}},[r("el-row",{attrs:{gutter:10}},[r("el-col",{attrs:{span:5}},[r("el-input",{attrs:{placeholder:"机器人名称",clearable:0==e.modify},model:{value:t.name,callback:function(r){e.$set(t,"name",r)},expression:"address.name"}})],1),e._v(" "),r("el-col",{attrs:{span:5}},[r("el-input",{attrs:{placeholder:"accessToken",clearable:0==e.modify},model:{value:t.groupAccessToken,callback:function(r){e.$set(t,"groupAccessToken",r)},expression:"address.groupAccessToken"}})],1),e._v(" "),r("el-col",{attrs:{span:5}},[r("el-input",{attrs:{placeholder:"规则条件",clearable:0==e.modify},model:{value:t.condition,callback:function(r){e.$set(t,"condition",r)},expression:"address.condition"}})],1),e._v(" "),r("el-col",{attrs:{span:5}},[r("el-input",{attrs:{placeholder:"Secret",clearable:0==e.modify},model:{value:t.secret,callback:function(r){e.$set(t,"secret",r)},expression:"address.secret"}})],1),e._v(" "),r("el-col",{attrs:{span:1}},[r("el-button",{attrs:{icon:"el-icon-plus",type:"primary",size:"small",circle:""},on:{click:e.addAddress}})],1),e._v(" "),r("el-col",{attrs:{span:1}},[e.board.addresses.length>1?r("el-button",{attrs:{icon:"el-icon-minus",type:"danger",size:"small",circle:""},on:{click:function(r){return e.removeAddress(t)}}}):e._e()],1)],1)],1)})),e._v(" "),r("el-form-item",[e.showSubmitBtn?r("el-button",{attrs:{type:"primary",disabled:e.submiting,loading:e.submiting},on:{click:e.doSubmit}},[e._v(e._s(e.submiting?"提交中...":"提 交"))]):e._e(),e._v(" "),r("router-link",{attrs:{to:"/board/group"}},[r("el-button",[e._v("取 消")])],1)],1)],2)],1)},o=[],i=(r("6b54"),r("e7d3")),s=r("16d8"),n={data:function(){return{board:{boardCode:"",boardName:"",messageType:"",title:"",content:"",atAll:"0",linkMessageUrl:"",linkPicUrl:"",addresses:[{name:"",groupAccessToken:"",condition:"",secret:""}]},rules:{boardCode:[{required:!0,message:"请输入模板编码",trigger:"blur"},{min:5,max:100,message:"长度在 5 到 100 个字符之间",trigger:"blur"}],boardName:[{required:!0,message:"请输入模板名称",trigger:"blur"},{min:1,max:100,message:"长度在 1 到 100 个字符之间",trigger:"blur"}],messageType:[{required:!0,message:"请选择消息类型",trigger:"change"}],name:[{required:!0,message:"请输入机器人名称",trigger:"blur"},{min:1,max:100,message:"长度在 1 到 100 个字符之间",trigger:"blur"}],accessToken:[{required:!0,message:"请输入机器人accessToken",trigger:"blur"},{min:1,max:100,message:"长度在 1 到 100 个字符之间",trigger:"blur"}]},modify:!1,showSubmitBtn:!0,submiting:!1}},components:{MarkdownEditor:s["a"]},created:function(){var e=this.$route.params;e.boardCode&&this.findData(e.boardCode)},methods:{findData:function(e){var t=this;Object(i["b"])(e).then((function(e){t.board=e,void 0!=e.atAll&&(t.board.atAll=e.atAll.toString()),t.modify=!0})).catch((function(e){t.$notify({title:"提示",type:"info",message:e.errorMsg}),t.showSubmitBtn=!1}))},addAddress:function(){this.board.addresses.push({name:"",groupAccessToken:"",condition:"",secret:""})},removeAddress:function(e){var t=this.board.addresses.indexOf(e);-1!==t&&this.board.addresses.splice(t,1)},doSubmit:function(){var e=this;this.submiting||this.$refs["boardForm"].validate((function(t){if(!t)return!1;e.modify?e.doModify():e.doCreate()}))},doCreate:function(){var e=this;this.submiting=!0,Object(i["a"])(this.board).then((function(t){e.$notify({title:"操作成功",type:"success",message:"模板创建成功!"}),setTimeout((function(){e.$router.push("/board/group")}),2e3)})).catch((function(t){e.submiting=!1,e.$notify({title:"操作失败("+t.errorCode+")",type:"error",message:t.errorMsg})}))},doModify:function(){var e=this;this.submiting=!0,Object(i["e"])(this.board).then((function(t){e.$notify({title:"操作成功",type:"success",message:"模板修改成功!"}),setTimeout((function(){e.$router.push("/board/group")}),2e3)})).catch((function(t){e.submiting=!1,e.$notify({title:"操作失败("+t.errorCode+")",type:"error",message:t.errorMsg})}))}}},l=n,d=r("2877"),c=Object(d["a"])(l,a,o,!1,null,"78c9cc56",null);t["default"]=c.exports},e7d3:function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return s})),r.d(t,"e",(function(){return n})),r.d(t,"f",(function(){return l})),r.d(t,"d",(function(){return d}));var a=r("b775");function o(e,t,r){return Object(a["a"])({url:"/groupBoard/list",method:"get",params:{pageNo:e,pageSize:t,query:r}})}function i(e){return Object(a["a"])({url:"/groupBoard/"+e,method:"get"})}function s(e){return Object(a["a"])({url:"/groupBoard/create",method:"post",data:e})}function n(e){return Object(a["a"])({url:"/groupBoard/modify",method:"post",data:e})}function l(e){return Object(a["a"])({url:"/groupBoard/remove",method:"post",params:{boardCode:e}})}function d(){return Object(a["a"])({url:"/groupBoard/cnt",method:"get"})}}}]);